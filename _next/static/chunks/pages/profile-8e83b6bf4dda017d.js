(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[63],{5499:()=>{},19674:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return a(56755)}])},49841:(e,t,a)=>{"use strict";a(5640),a(5499)},56755:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var r=a(5640);a(49841);var s=a(50148),l=a(43054),o=a(59581),i=a(76460),n=a(73143),c=a(59846),d=a(50755),u=a(32941),m=a(84690),x=a(12300),p=a(15967),h=a(33539),g=a(43297);function b(){var e,t;let[a,b]=(0,s.useState)(null),[f,j]=(0,s.useState)([]),[v,w]=(0,s.useState)([]),[y,N]=(0,s.useState)(0),[k,C]=(0,s.useState)(0),[z,S]=(0,s.useState)(!0),[_,I]=(0,s.useState)(!0),[P,E]=(0,s.useState)(!1),[A,T]=(0,s.useState)({username:"",email:"",password:""}),[O,F]=(0,s.useState)(null),[H,G]=(0,s.useState)("dedicated"),[R,q]=(0,s.useState)(!1),[B,D]=(0,s.useState)({message:"",type:""}),K=(0,s.useRef)(),L=JSON.parse(localStorage.getItem("user"));(0,s.useEffect)(()=>{L&&(l.A.get("".concat("https://aurapp.onrender.com","/api/users/").concat(L._id)).then(e=>{b(e.data),T({username:e.data.username,email:e.data.email,password:""})}),W("dedicated"),W("authored"))},[]);let W=async e=>{let t="dedicated"===e?y:k,a=(await l.A.get("".concat("https://aurapp.onrender.com","/api/posts/user/").concat(L._id))).data.filter(t=>{var a,r;return"dedicated"===e?(null==(a=t.dedicatedTo)?void 0:a._id)===L._id:(null==(r=t.author)?void 0:r._id)===L._id}).slice(t,t+10);"dedicated"===e?(j(e=>[...e,...a]),N(e=>e+10),a.length<10&&S(!1)):(w(e=>[...e,...a]),C(e=>e+10),a.length<10&&I(!1))},X=e=>{K.current&&K.current.disconnect(),K.current=new IntersectionObserver(e=>{e[0].isIntersecting&&("dedicated"===H&&z&&W("dedicated"),"authored"===H&&_&&W("authored"))}),e&&K.current.observe(e)},J=async e=>{let t=new FormData;t.append("file",e),t.append("upload_preset","userImages");try{let{secure_url:e,public_id:a}=(await l.A.post("https://api.cloudinary.com/v1_1/".concat("dqa9w2ug1","/image/upload"),t,{headers:{"Content-Type":"multipart/form-data"}})).data;return[e,a]}catch(e){return console.error("Error al subir imagen:",e),null}},U=async()=>{q(!0);try{let e=a.profileImage,t=a.imagePublicId,r=a.imagePublicId;if(O){let a=await J(O);if(!a)throw Error("Fall\xf3 la subida de imagen");e=a[0],t=a[1]}let s={username:A.username,email:A.email,password:A.password,newImage:{profileImage:e,imagePublicId:t},oldImagePublicId:r};await l.A.put("".concat("https://aurapp.onrender.com","/api/users/").concat(a._id,"/data"),s);let o=await l.A.get("".concat("https://aurapp.onrender.com","/api/users/").concat(a._id));b(o.data),E(!1),D({message:"Perfil actualizado con \xe9xito",type:"success"})}catch(e){console.error("Error al guardar los cambios:",e),D({message:"Hubo un error al guardar",type:"error"})}finally{q(!1),setTimeout(()=>D({message:"",type:""}),3e3)}},M=(t=null==a?void 0:a.aura)<500?"rose":t<1500?"indigo":t<2e3?"emerald":"yellow",Y=(null==a||null==(e=a.auraHistory)?void 0:e.map(e=>({date:new Date(e.date).toLocaleDateString(),aura:e.value})))||[];return a?(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-tr from-neutral-950 via-".concat(M,"-950 to-").concat(M,"-600 text-zinc-50"),children:[(0,r.jsx)(o.A,{}),(0,r.jsx)("div",{className:"hidden  bg-rose-600 hover:bg-rose-700 border-rose-600 to-rose-600 to-rose-950 bg-indigo-600 hover:bg-indigo-700 border-indigo-600 to-indigo-600 to-indigo-950 bg-emerald-600 hover:bg-emerald-700 border-emerald-600 to-emerald-600 to-emerald-950  bg-yellow-600 hover:bg-yellow-700 border-yellow-600 to-yellow-600 to-yellow-950"}),(0,r.jsxs)("div",{className:"pt-24 px-4 flex flex-col items-center gap-4",children:[(0,r.jsx)("div",{className:"relative w-32 h-32",children:(0,r.jsx)("img",{src:a.profileImage,alt:"Perfil",className:"rounded-full w-full h-full object-cover border-4 shadow border-white"})}),(0,r.jsx)("h1",{className:"text-3xl font-bold",children:a.username}),(0,r.jsxs)("div",{className:"text-lg font-semibold",children:["Aura: ",a.aura]}),(0,r.jsx)("button",{onClick:()=>E(!0),className:"cursor-pointer bg-".concat(M,"-600 hover:bg-").concat(M,"-700 text-white px-4 py-2 rounded-lg"),children:"Editar perfil"}),(0,r.jsxs)("div",{className:"w-full max-w-2xl mt-6",children:[(0,r.jsx)("div",{className:"flex border-b mb-4",children:["dedicated","authored","aura"].map(e=>(0,r.jsx)("button",{onClick:()=>G(e),className:"cursor-pointer flex-1 py-2 ".concat(H===e?"border-b-2 border-".concat(M,"-600 font-bold"):"text-zinc-400"),children:"dedicated"===e?"Posts dedicados":"authored"===e?"Posts creados":"Historial de Aura"},e))}),"dedicated"===H&&f.map((e,t)=>(0,r.jsx)("div",{className:"mb-6",ref:t===f.length-1?X:null,children:(0,r.jsx)(i.A,{post:e})},e._id)),"authored"===H&&v.map((e,t)=>(0,r.jsx)("div",{className:"mb-6",ref:t===v.length-1?X:null,children:(0,r.jsx)(i.A,{post:e})},e._id)),"aura"===H&&(0,r.jsx)(u.u,{width:"100%",height:300,children:(0,r.jsxs)(m.b,{data:Y,children:[(0,r.jsx)(x.W,{dataKey:"date",stroke:"#8884d8"}),(0,r.jsx)(p.h,{stroke:"#8884d8"}),(0,r.jsx)(h.m,{}),(0,r.jsx)(g.N,{type:"monotone",dataKey:"aura",stroke:"#8884d8",strokeWidth:2})]})})]})]}),(0,r.jsx)(c.e,{show:P,as:s.Fragment,children:(0,r.jsx)(d.lG,{as:"div",className:"fixed inset-0 z-50 overflow-y-auto",onClose:()=>E(!1),children:(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-black/30 p-4",children:(0,r.jsx)(c.e.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,r.jsxs)(d.lG.Panel,{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md transform transition-all",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Editar Perfil"}),(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"relative w-24 h-24 mx-auto",children:[(0,r.jsx)("img",{src:O?URL.createObjectURL(O):a.profileImage,className:"rounded-full w-full h-full object-cover border"}),(0,r.jsxs)("label",{className:"absolute bottom-0 right-0 p-1 bg-white/80 rounded-full cursor-pointer",children:[(0,r.jsx)(n.SG1,{className:"text-gray-800"}),(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:e=>F(e.target.files[0]),className:"hidden"})]})]}),(0,r.jsx)("input",{type:"text",placeholder:"Nombre de usuario",value:A.username,onChange:e=>T({...A,username:e.target.value}),className:"border p-2 rounded"}),(0,r.jsx)("input",{type:"email",placeholder:"Correo",value:A.email,onChange:e=>T({...A,email:e.target.value}),className:"border p-2 rounded"}),(0,r.jsx)("input",{type:"password",placeholder:"Nueva contrase\xf1a",value:A.password,onChange:e=>T({...A,password:e.target.value}),className:"border p-2 rounded"}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,r.jsx)("button",{onClick:()=>E(!1),className:"cursor-pointer px-4 py-2 bg-gray-300 dark:bg-gray-700 hover:bg-gray-600 rounded",children:"Cancelar"}),(0,r.jsx)("button",{onClick:U,disabled:R,className:"cursor-pointer px-4 py-2 flex items-center justify-center gap-2 bg-".concat(M,"-600 hover:bg-").concat(M,"-700 text-white rounded disabled:opacity-60"),children:R?(0,r.jsxs)("svg",{className:"animate-spin h-5 w-5 text-white",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]}):"Guardar"})]}),B.message&&(0,r.jsx)("div",{className:"mt-4 px-4 py-2 text-sm rounded text-center ".concat("success"===B.type?"bg-green-600 text-white":"bg-red-600 text-white"),children:B.message})]})]})})})})})]}):null}},59581:(e,t,a)=>{"use strict";a.d(t,{A:()=>m});var r=a(5640),s=a(86826),l=a.n(s),o=a(87060),i=a(50148),n=a(94556);function c(e){let{isOpen:t,toggle:a}=e;return(0,r.jsxs)("button",{onClick:a,className:"cursor-pointer relative z-50 w-5 h-5 flex flex-col justify-between items-center",children:[(0,r.jsx)(n.P.span,{animate:{rotate:45*!!t,y:8*!!t},className:"w-full h-1 bg-white rounded origin-center",transition:{duration:.3}}),(0,r.jsx)(n.P.span,{animate:{opacity:+!t},className:"w-full h-1 bg-white rounded",transition:{duration:.3}}),(0,r.jsx)(n.P.span,{animate:{rotate:t?-45:0,y:t?-8:0},className:"w-full h-1 bg-white rounded origin-center",transition:{duration:.3}})]})}var d=a(70829);function u(e){let{isOpen:t,children:a}=e;return(0,r.jsx)(d.N,{children:t&&(0,r.jsx)(n.P.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},transition:{duration:.3},className:"absolute top-0 left-0 w-full bg-black bg-opacity-90 flex flex-col items-center py-6 z-40",children:a})})}function m(e){let{aura:t}=e,[a,s]=(0,i.useState)(!1),n=(0,o.useRouter)(),d=()=>s(!a),m=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),n.replace("/")};return(0,r.jsxs)("nav",{className:"fixed top-0 left-0 w-full px-4 py-2 flex justify-between items-center bg-black z-50",children:[(0,r.jsx)("h1",{className:"text-white font-bold text-xl",children:"Aurapp"}),(0,r.jsx)(c,{isOpen:a,toggle:d}),(0,r.jsxs)(u,{isOpen:a,children:[(0,r.jsx)("a",{href:"/home/#inicio",onClick:d,className:"text-white text-lg my-2",children:"Inicio"}),(0,r.jsx)("a",{href:"/home/#ranking",onClick:d,className:"text-white text-lg my-2",children:"Ranking"}),(0,r.jsx)(l(),{href:{pathname:"/posts",query:{aura:t}},passHref:!0,className:"text-white text-lg my-2",onClick:d,children:"Posts"}),(0,r.jsx)(l(),{href:{pathname:"/profile",query:{aura:t}},passHref:!0,className:"text-white text-lg my-2",onClick:d,children:"Perfil"}),(0,r.jsx)("button",{onClick:()=>{d(),m()},className:"cursor-pointer text-white text-lg my-2 text-left",children:"Cerrar sesi\xf3n"})]})]})}},76460:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var r=a(5640),s=a(50148),l=a(94556),o=a(73143),i=a(43054);function n(e){let{post:t}=e,[a,n]=(0,s.useState)({upvote:t.tickCount,downvote:t.crossCount,selected:null}),[c,d]=(0,s.useState)(""),[u,m]=(0,s.useState)(!1),x=t._id;(0,s.useEffect)(()=>{let e=JSON.parse(localStorage.getItem("user"));d((null==e?void 0:e._id)||"")},[]),(0,s.useEffect)(()=>{let e=t.upvotedBy.map(e=>e.toString()).includes(c),a=t.downvotedBy.map(e=>e.toString()).includes(c);n({upvote:t.tickCount,downvote:t.crossCount,selected:e?"upvote":a?"downvote":null})},[t,c]);let p=async e=>{if(a.selected!==e)try{let t=(await i.A.post("".concat("https://aurapp.onrender.com","posts/vote/").concat(x),{userId:c,voteType:e})).data;n({upvote:t.tickCount,downvote:t.crossCount,selected:e})}catch(e){console.error("Error al votar:",e)}},h=async()=>{try{await i.A.delete("".concat("https://aurapp.onrender.com","posts/").concat(x)),m(!1),window.location.reload()}catch(e){console.error("Error al eliminar el post:",e)}};return(0,r.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-2xl shadow-md max-w-sm mx-auto overflow-hidden",children:[(0,r.jsxs)("div",{className:"relative aspect-[4/4] w-full",children:[(0,r.jsx)("img",{src:t.image,alt:"Post",className:"w-full h-full object-cover rounded-t-2xl"}),(0,r.jsx)("div",{className:"absolute top-3 right-3 bg-white dark:bg-zinc-800 p-1.5 rounded-full shadow",children:t.auraImpactApplied?(0,r.jsx)(o.F5$,{className:"text-zinc-700 dark:text-white text-lg"}):(0,r.jsx)(o.K4k,{className:"text-zinc-700 dark:text-white text-lg"})}),c===t.author._id&&(0,r.jsx)("button",{onClick:()=>m(!0),className:"cursor-pointer absolute top-3 left-3 bg-rose-600 hover:bg-rose-700 p-1.5 rounded-full text-white shadow",title:"Eliminar post",children:(0,r.jsx)(o.IXo,{className:"text-base"})})]}),(0,r.jsxs)("div",{className:"p-5 space-y-3",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-zinc-900 dark:text-white truncate",children:t.dedicatedTo.username}),(0,r.jsx)("span",{className:"text-xl font-bold ".concat(t.aura>0?"text-emerald-500":"text-rose-500"),children:t.aura>0?"+".concat(t.aura):t.aura})]}),(0,r.jsx)("p",{className:"text-sm text-zinc-700 dark:text-zinc-300",children:t.description}),(0,r.jsxs)("div",{className:"flex justify-between items-center pt-3 border-t border-zinc-200 dark:border-zinc-700",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("img",{src:t.author.profileImage,alt:"Avatar",className:"w-9 h-9 rounded-full object-cover border"}),(0,r.jsx)("span",{className:"text-sm text-zinc-800 dark:text-zinc-200 font-medium",children:t.author.username})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("button",{onClick:()=>p("upvote"),className:"cursor-pointer p-2 rounded-full border border-emerald-400 transition duration-150 ".concat("upvote"===a.selected?"bg-emerald-100":"hover:bg-emerald-50"),children:(0,r.jsx)(o.YrT,{className:"text-green-600 text-lg"})}),(0,r.jsx)("span",{className:"text-sm text-zinc-800 dark:text-zinc-200",children:a.upvote}),(0,r.jsx)("button",{onClick:()=>p("downvote"),className:"cursor-pointer p-2 rounded-full border border-rose-400 transition duration-150 ".concat("downvote"===a.selected?"bg-rose-100":"hover:bg-rose-50"),children:(0,r.jsx)(o.yGN,{className:"text-red-600 text-lg"})}),(0,r.jsx)("span",{className:"text-sm text-zinc-800 dark:text-zinc-200",children:a.downvote})]})]})]}),u&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"mr-4 ml-4 bg-white dark:bg-zinc-900 p-6 rounded-xl shadow-lg max-w-sm w-full text-center space-y-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-rose-600",children:"\xbfEliminar post?"}),(0,r.jsx)("p",{className:"text-sm text-zinc-700 dark:text-zinc-300",children:"Esta acci\xf3n no se puede deshacer."}),(0,r.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,r.jsx)("button",{onClick:()=>m(!1),className:"cursor-pointer px-4 py-2 rounded-md bg-zinc-200 dark:bg-zinc-700 text-sm hover:bg-zinc-300 dark:hover:bg-zinc-600",children:"Cancelar"}),(0,r.jsx)("button",{onClick:h,className:"cursor-pointer px-4 py-2 rounded-md bg-rose-600 text-white text-sm hover:bg-rose-700",children:"Confirmar"})]})]})})]})}a(49841)}},e=>{var t=t=>e(e.s=t);e.O(0,[394,715,405,315,636,593,792],()=>t(19674)),_N_E=e.O()}]);