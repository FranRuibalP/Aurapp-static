(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[642],{5499:()=>{},13180:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var r=a(5640),l=a(50148),s=a(59581),n=a(73151),i=a(87060),o=a(43054);a(49841);var c=a(66064);function d(){let[e,t]=(0,l.useState)(0),[a,d]=(0,l.useState)(""),[u,m]=(0,l.useState)(!1),[x,h]=(0,l.useState)(null),[p,b]=(0,l.useState)(null),[f,g]=(0,l.useState)(""),[w,N]=(0,l.useState)([]),[j,y]=(0,l.useState)(""),[v,k]=(0,l.useState)(!1),_=(0,i.useRouter)();(0,l.useEffect)(()=>{let e=localStorage.getItem("user");if(e)try{let t=JSON.parse(e);g(t._id)}catch(e){console.error("Error parsing user from localStorage:",e)}o.A.get("".concat(c.env.NEXT_PUBLIC_URL_BACKEND,"users")).then(e=>{N(e.data.map(e=>({id:e._id,name:e.username})))}).catch(e=>{console.error("Error al obtener usuarios:",e)})},[]);let C=async e=>{let t=new FormData;t.append("file",e),t.append("upload_preset","postsImages");try{let{secure_url:e,public_id:a}=(await o.A.post("https://api.cloudinary.com/v1_1/".concat(c.env.NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME,"/image/upload"),t,{headers:{"Content-Type":"multipart/form-data"}})).data;return[e,a]}catch(e){return console.error("Error al subir imagen:",e),[null,null]}},E=e=>{t(t=>t+e)},S=0!==e&&""!==a.trim()&&""!==j&&null!==x,{number:A}=(0,n.zh)({number:e,from:{number:0},config:{tension:170,friction:26}}),P=async()=>{k(!0);let t=[null,null];x&&(t=await C(x));let r={author:f,dedicatedTo:j,description:a,aura:e,image:t[0],imagePublicId:t[1],auraImpactApplied:u};try{await o.A.post("".concat(c.env.NEXT_PUBLIC_URL_BACKEND,"/api/posts"),r),u&&await o.A.post("".concat(c.env.NEXT_PUBLIC_URL_BACKEND,"/api/users/").concat(j,"/aura"),{aura:e}),_.replace("/posts")}catch(e){t[1]&&await o.A.post("".concat(c.env.NEXT_PUBLIC_URL_BACKEND,"/api/cloudinary/delete"),{public_id:t[1]}),console.error("Error al postear:",e),k(!1)}};return(0,r.jsxs)("div",{className:"min-h-screen p-6 bg-neutral-50 dark:bg-neutral-900",children:[(0,r.jsx)(s.A,{}),(0,r.jsx)("h1",{className:"text-center text-2xl font-bold mt-10 mb-6 dark:text-white text-black",children:"Ajuste de Aura"}),(0,r.jsx)("div",{className:"text-6xl font-bold text-center mb-6 dark:text-white text-black",children:(0,r.jsx)(n.CS.span,{children:A.to(e=>Math.floor(e))})}),(0,r.jsx)("div",{className:"flex flex-col item-center justify-center gap-10 mb-6",children:(0,r.jsx)("div",{className:"flex justify-center gap-4",children:[50,100,500].map(e=>(0,r.jsxs)("button",{onClick:()=>E(e),className:"cursor-pointer bg-indigo-600 text-white font-semibold px-5 py-2 rounded-full hover:bg-indigo-700",children:["+",e]},"add-".concat(e)))})}),(0,r.jsx)("div",{className:"flex justify-center gap-4 mb-6",children:[50,100,500].map(e=>(0,r.jsxs)("button",{onClick:()=>E(-e),className:"cursor-pointer border-2 border-indigo-600 text-indigo-600 font-semibold px-5 py-2 rounded-full bg-transparent hover:bg-indigo-900 hover:text-white",children:["-",e]},"sub-".concat(e)))}),p&&(0,r.jsx)("div",{className:"flex justify-center mb-4",children:(0,r.jsx)("img",{src:p,alt:"Preview",className:"w-48 h-auto rounded shadow"})}),(0,r.jsxs)("div",{className:"mb-6 text-center",children:[(0,r.jsx)("label",{className:"block mb-2 font-medium text-black dark:text-white",children:"Sub\xed una imagen"}),(0,r.jsx)("input",{type:"file",accept:"image/*",id:"file-upload",onChange:e=>{let t=e.target.files[0];t&&(h(t),b(URL.createObjectURL(t)))},className:"hidden"}),(0,r.jsx)("label",{htmlFor:"file-upload",className:"inline-block px-5 py-2 rounded-full cursor-pointer font-semibold bg-indigo-600 text-white hover:bg-indigo-700 transition",children:"Elegir imagen"})]}),(0,r.jsxs)("div",{className:"mb-6 max-w-xl mx-auto w-full",children:[(0,r.jsx)("label",{className:"block mb-2 font-medium text-black dark:text-white",children:"Eleg\xed destinatario del aura"}),(0,r.jsxs)("select",{value:j,onChange:e=>y(e.target.value),className:"w-full p-3 rounded border dark:bg-gray-800 dark:text-white dark:border-gray-600 text-black",children:[(0,r.jsx)("option",{value:"",disabled:!0,children:"Seleccion\xe1 un usuario"}),w.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"mb-6 max-w-xl mx-auto w-full",children:[(0,r.jsx)("label",{className:"block mb-2 font-medium text-black dark:text-white",children:"Descripci\xf3n"}),(0,r.jsx)("textarea",{value:a,onChange:e=>d(e.target.value),placeholder:"Explic\xe1 el motivo del cambio...",className:"w-full p-3 rounded border dark:bg-gray-800 dark:text-white dark:border-gray-600 text-black",rows:4})]}),(0,r.jsxs)("div",{className:"flex justify-center items-center gap-3 mb-6",children:[(0,r.jsx)("div",{onClick:()=>m(!u),className:"w-12 h-6 flex items-center rounded-full p-1 cursor-pointer transition-colors ".concat(u?"bg-indigo-600":"bg-gray-300 border border-gray-400"),children:(0,r.jsx)("div",{className:"bg-white w-4 h-4 rounded-full shadow-md transform transition-transform ".concat(u?"translate-x-6":"translate-x-0")})}),(0,r.jsx)("span",{className:"text-black dark:text-white",children:"Inmediato"})]}),(0,r.jsxs)("div",{className:"flex justify-center items-center relative mt-4",children:[(0,r.jsx)("button",{onClick:P,disabled:!S||v,className:"cursor-pointer px-6 py-3 rounded font-bold ".concat(S&&!v?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-gray-400 text-white cursor-not-allowed"),children:"Postear"}),v&&(0,r.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:(0,r.jsx)("div",{className:"w-6 h-6 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin"})})]})]})}},49841:(e,t,a)=>{"use strict";a(5640),a(5499)},59581:(e,t,a)=>{"use strict";a.d(t,{A:()=>m});var r=a(5640),l=a(86826),s=a.n(l),n=a(87060),i=a(50148),o=a(94556);function c(e){let{isOpen:t,toggle:a}=e;return(0,r.jsxs)("button",{onClick:a,className:"cursor-pointer relative z-50 w-5 h-5 flex flex-col justify-between items-center",children:[(0,r.jsx)(o.P.span,{animate:{rotate:45*!!t,y:8*!!t},className:"w-full h-1 bg-white rounded origin-center",transition:{duration:.3}}),(0,r.jsx)(o.P.span,{animate:{opacity:+!t},className:"w-full h-1 bg-white rounded",transition:{duration:.3}}),(0,r.jsx)(o.P.span,{animate:{rotate:t?-45:0,y:t?-8:0},className:"w-full h-1 bg-white rounded origin-center",transition:{duration:.3}})]})}var d=a(70829);function u(e){let{isOpen:t,children:a}=e;return(0,r.jsx)(d.N,{children:t&&(0,r.jsx)(o.P.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},transition:{duration:.3},className:"absolute top-0 left-0 w-full bg-black bg-opacity-90 flex flex-col items-center py-6 z-40",children:a})})}function m(e){let{aura:t}=e,[a,l]=(0,i.useState)(!1),o=(0,n.useRouter)(),d=()=>l(!a),m=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),o.replace("/")};return(0,r.jsxs)("nav",{className:"fixed top-0 left-0 w-full px-4 py-2 flex justify-between items-center bg-black z-50",children:[(0,r.jsx)("h1",{className:"text-white font-bold text-xl",children:"Aurapp"}),(0,r.jsx)(c,{isOpen:a,toggle:d}),(0,r.jsxs)(u,{isOpen:a,children:[(0,r.jsx)("a",{href:"/home/#inicio",onClick:d,className:"text-white text-lg my-2",children:"Inicio"}),(0,r.jsx)("a",{href:"/home/#ranking",onClick:d,className:"text-white text-lg my-2",children:"Ranking"}),(0,r.jsx)(s(),{href:{pathname:"/posts",query:{aura:t}},passHref:!0,className:"text-white text-lg my-2",onClick:d,children:"Posts"}),(0,r.jsx)(s(),{href:{pathname:"/profile",query:{aura:t}},passHref:!0,className:"text-white text-lg my-2",onClick:d,children:"Perfil"}),(0,r.jsx)("button",{onClick:()=>{d(),m()},className:"cursor-pointer text-white text-lg my-2 text-left",children:"Cerrar sesi\xf3n"})]})]})}},67264:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/post-aura",function(){return a(13180)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[715,151,315,636,593,792],()=>t(67264)),_N_E=e.O()}]);